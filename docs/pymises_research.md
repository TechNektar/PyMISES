
# Introduction 
Mark Drela’s MISES (Multiple blade *Interacting* Streamtube Euler Solver) is a quasi-3D flow simulation system for turbomachinery cascades ([MISES - Software for Design and Analysis of Turbomachinery Blading | MIT Technology Licensing Office](https://tlo.mit.edu/industry-entrepreneurs/available-technologies/mises-software-design-and-analysis-turbomachinery#:~:text=wide%20range%20of%20Mach%20and,glows%20including%20transition%20and%20separation)). It couples a blade-to-blade inviscid flow solution with integral boundary layer (BL) equations to efficiently predict performance over a wide range of Mach and Reynolds numbers. The goal of this project is to recreate the full functionality of MISES in Python, including mesh generation, inviscid Euler/potential flow solving, viscous boundary layer modeling with transition, iterative viscous–inviscid coupling, inverse design capabilities, modern I/O handling, and visualization tools. This report outlines the technical architecture and numerical methods for each component, referencing Drela’s original work and validation studies. The Python implementation will maintain the modular structure of MISES (grid initializer, flow solver, etc.) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=the%20prescribed%20loss%20schedule%20file,state%20file%20and%20a%20flow)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=EDP%20pressure%20edit%20program,and%20geometry%20data%20from%20the)) while leveraging modern data structures and libraries for flexibility and clarity.

## Mesh Generation and Streamsurface Coordinates 
**Blade Geometry Input:** MISES accepts blade shapes either as discrete surface coordinates or via parametric definitions. In the original code, a file `blade.xxx` lists point coordinates around the airfoil, and an alternative `bparm.xxx` file can provide a set of geometry parameters for user-defined generative routines ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=blade,shape%20via%20a%20relatively%20large)). For our Python version, we will support both modes by allowing direct coordinate input (e.g. from CAD or point cloud) and analytic geometry descriptions (camber/thickness distributions, Bezier or B-spline control points, etc.). Internally, all geometries will be converted to a common representation – a dense set of surface points defining the suction and pressure side in sequence. These points are then transformed onto the *stream surface* coordinate system (m′–θ plane) used by MISES ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=The%20blade%20airfoil%20and%20grid,standard%20m%E2%80%B2%20%E2%88%92%20%CE%B8%20streamsurface)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=%E2%88%9A%20dr2%20%2B%20dz2)). The stream surface coordinates account for the blade’s spanwise curvature by defining a meridional distance coordinate m′ and the circumferential (theta) position. The transformation is *conformal* (angle-preserving), meaning flow angles and normal directions are unchanged by the mapping ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=explicitly%20in%20MISES)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=no%20transformation%20is%20required%20for,This%20simplifies)). This greatly simplifies imposing flow boundary conditions and the eventual normal displacement of the wall for viscous thickness effects. For strictly two-dimensional cases (zero curvature), m′ reduces to the axial coordinate (z) scaled by radius ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=For%202,constant%20scaling%20length%2C%20and%20hence)), whereas for truly 3D blade sections the m′ coordinate is obtained by numerical integration along the spanwise curved surface ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=definition%20might%20also)).  

**Grid Topology and Initialization:** Once the blade contour is defined in the m′–θ plane, an initial grid (mesh) is generated to discretize the flow domain between blade passages. We will implement both *I-type (offset)* and *H-type (periodic)* grid topologies, following MISES conventions ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=%E2%80%9Ct%E2%80%9D%20specifies%20an%20offset)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=other%20hand%2C%20a%20nearly,fewer%20streamlines%2C%20which%20mostly%20alleviates)). An **I-type grid** (also called an “offset” or C-type grid) is one where grid lines emanate roughly normal from the blade surfaces and wrap around, not directly connecting to the adjacent periodic boundaries. This produces a grid that is nearly orthogonal to the blade surface, improving resolution of boundary layers and shock waves at the cost of a more complex connectivity (and a larger matrix bandwidth in implicit solves) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=inlet%20and%20outlet,it%20increases%20the%20Newton%20matrix)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=other%20hand%2C%20a%20nearly,fewer%20streamlines%2C%20which%20mostly%20alleviates)). In contrast, an **H-type grid** has grid lines that go straight from one blade to the next across the passage, meeting the periodic boundaries, which is simpler but can lead to highly skewed cells near leading and trailing edges. MISES allows using different types at the inlet and outlet: for example, a common best practice is a periodic grid upstream and an offset grid downstream for transonic turbine cascades, to handle upstream subsonic flow easily while capturing a shock at the trailing edge with orthogonal cells ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=Flags%20Case)). Our Python mesh generator will allow similar flexibility via flags for inlet/outlet topology. It will also accept parameters for grid density — e.g. number of points along the blade surfaces, number of grid lines (or “streamlines”) across the passage, and spacing stretching factors — analogous to MISES’s options (“I”, “O”, “S”, etc.) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=G%20t%20t%20inlet%2Coutlet%20offset,grid%20flags)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=The%20number%20of%20inlet%20and,These)). Initial surface grid spacing will be set based on curvature and leading/trailing edge clustering, ensuring adequate resolution of thin leading edge stagnation regions and the suction side adverse pressure gradient region. The grid generation will also include **streamsurface thickness distribution**: for quasi-3D cases with streamtube contraction/expansion, the `stream.xxx` file in MISES specifies the distribution of streamtube height (radius or thickness) along m′ ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=stream.xxx%20Required%20except%20for%20strictly,Specifies%20streamsurface%20radius%20and%20thick)). We will incorporate this by allowing an axial (m′) distribution of channel height, which shapes the flow area variation (important for compressibility and flow acceleration). Finally, the mesh is smoothed to remove any high-aspect-ratio or skewed cells using a relaxation procedure (analogous to the SLOR smoothing in ISET) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=other%20hand%2C%20a%20nearly,fewer%20streamlines%2C%20which%20mostly%20alleviates)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=The%20%E2%80%9CX,normal%20grid%20lines)), yielding a quality computational grid.

## Inviscid Flow Solver (Euler/Panel Method) 
The inviscid core flow in MISES can be computed either by a potential flow panel method (suitable for subsonic incompressible flows) or by a finite-volume Euler solver (for compressible flows with shocks). Our Python solver will mirror this flexibility. For subsonic blade flows, a classical linear-strength panel method with vortex/source panels on the blade surface can be used to obtain the circulation and surface pressure distribution quickly ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=ISES%20is%20the%20main%20program,always%20reads%20the%20two%20required)). This provides an initial guess for the flow field and was historically used in MISES’s grid generator (ISET) to position streamlines ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=match%20at%20L701%20SOUT%20is,grid%20generator%20in%20ISET)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=CHINL%20is%20the%20distance%20in,to%20the%20grid%20inflow%20plane)). However, for general use (and certainly for transonic flows), we will implement a 2D Euler solver on the blade-to-blade grid. The Euler equations (steady, relative frame) are solved in conservative form with options to enforce either strict momentum conservation or an “isentropic” formulation. In fact, MISES allows a continuum between a full Euler solver and a full-potential (zero loss) solver via the ISMOM parameter ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=ISMOM%3D1%20gives%20a%20standard%20momentum,solver%2C%20while%20ISMOM%3D2%20gives%20the)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=which%20attempt%20to%20make%20the,types%20of%20solvers%3A%20correct%20Rankine)). We will adopt a similar approach: by default, solve the axial and tangential momentum equations (giving true Euler physics with shock captures and entropy generation), but allow a mode where we instead enforce isentropic flow except across shocks (to reduce numerical dissipation). Drela’s hybrid approach uses different equations in different regions to combine the advantages of each ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=solver)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=MISES%20v%202,which%20makes%20all%20cells%20isen)). In Python, we might not need to regionally change equations, but we will include the option to toggle an “entropy conservation” mode that essentially zeroes out artificial viscosity away from shocks, mimicking the full-potential solver’s ability to avoid total pressure loss ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=which%20attempt%20to%20make%20the,types%20of%20solvers%3A%20correct%20Rankine)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=tropic%20except%20those%20where%20artificial,significantly%20to%20the%20momentum%20flux)). 

**Numerical Scheme:** The Euler solver will likely use a finite-volume formulation on the structured grid, employing a second-order spatial discretization with artificial dissipation for stability. MISES employs an implicit Newton method to converge the flow, which is efficient and allows large CFL numbers ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=inlet%20and%20outlet,it%20increases%20the%20Newton%20matrix)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=other%20hand%2C%20a%20nearly,fewer%20streamlines%2C%20which%20mostly%20alleviates)). In Python, an explicit time-marching scheme with local time-stepping could be used initially for simplicity, but for performance we will consider a pseudo-time Newton iteration (possibly using SciPy nonlinear solvers or our own Gauss-Seidel relaxation loops). Shock capturing will be handled via artificial dissipation terms similar to Jameson’s method – MISES defines parameters *Mcrit* and *Cμ* that control the threshold Mach number for adding second- and fourth-order dissipation ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=For%20Mcrit%20,values%2C%20which%20asymptote%20rapidly%20to)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=ways%20as%20shown%20in%20Figure,shock%20profile%20is%20shown%20in)). We will include tunable parameters in the Python solver to adjust dissipation; for instance, smearing of weak shocks can be controlled by lowering the Mach threshold for adding viscosity ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=Figure%204%3A%20Effect%20of%20the,structure%20of%20weak%20and%20strong)). By default, we’ll choose settings that yield crisp shock resolution without excessive smearing, since *Cμ ≈ 1* and *Mcrit ≈ 1* are recommended for clean normal shocks ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=Figure%203,For%20oblique)). The solver will apply proper cascade boundary conditions: periodicity in the tangential (θ) direction, and specified inflow total conditions and outflow static pressure (or mass flow) in the axial (m′) direction ([](https://web.mit.edu/drela/Public/web/mises/mises.pdf#:~:text=between%20r%2Cb%20at%20the%20inlet,r%20b%20%CB%86%20%3D%20%CF%811u1r1b1)) ([](https://web.mit.edu/drela/Public/web/mises/mises.pdf#:~:text=%21%E2%88%92%CE%B3%2F%CE%B3%E2%88%921%20%3D%20poa%20%CE%B3%20%CE%B3%E2%88%921,u%CB%86%202%20%2B%20%CB%86v2)). A Kutta condition is enforced at the blade trailing edge either by explicitly equalizing pressure on pressure and suction sides or by implicitly including a circulation constraint; MISES treats this via a global constraint in the system ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=does%20not%20admit%20any%20non,exit%20slope%20variable%20DSLEX)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=,or%20by%20specifying)), and we will enforce it in our solver to avoid pressure singularities at the trailing edge. 

To validate our inviscid solver, we will ensure it reproduces known solutions: for instance, the classic *Stanitz* cascade or a simple flat plate cascade can be used to test the panel method, and a transonic nozzle-like passage can test the Euler shock-capturing. MISES is known to be relatively insensitive to grid density compared to typical Euler solvers (behaving “more like a potential solver” especially in entropy-conserving mode) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=Compared%20to%20most%20Euler%20solvers%2C,It%20behaves)), so we will verify that coarsening the grid does not significantly alter our results – a sign that the numerical scheme is stable and accurate.

## Boundary Layer Modeling (Integral Equations) 
A key strength of MISES is its integral boundary layer (BL) formulation, which computes the growth of the laminar and turbulent boundary layers on the blade surfaces with minimal cost. We will implement a two-equation integral BL model akin to Drela’s design ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=2%20%CE%BB%20,fully%20resolves%20the%20viscous%2Finviscid%20interaction)). The primary quantity tracked is the *momentum thickness* θ along each surface, obtained from the momentum integral equation. An additional equation is needed to close the system; Drela uses either an empirical relation for shape factor *H* or an entrainment equation. In MISES (and the related XFOIL code), the two-equation model typically consists of the momentum thickness equation and an *energy thickness* (or kinetic energy thickness) equation with a semi-empirical closure that accounts for turbulent shear production (this allows capturing non-linear effects like relaminarization or mild separation). In our implementation, we will solve for θ and a second variable which could be the shape factor *H = δ*/θ or a related measure. For laminar flow, we will use the Thwaites’ method or similar to provide closure – Thwaites’ lag-entrainment method gives a relation between *H* and a pressure gradient parameter (the *Thwaites lambda*). In fact, the Abu-Ghannam and Shaw (AGS) transition correlation employed by MISES is defined in terms of the momentum thickness Reynolds number *Re<sub>θ</sub>* and the Thwaites pressure gradient parameter λ ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=1%20Ill,where%20%CE%BB%20%E2%89%A1%20%CE%B8%202)). For turbulent flow, we will adopt a modified Head’s entrainment method or the CN method (Green’s lag equation) that Drela refined. These integral methods require modeling the shear stress or entrainment rate; we will calibrate our models to match the behavior described in the MISES manual and thesis.

**Laminar–Turbulent Transition:** Transition is predicted using the AGS correlation (with Drela’s modifications for stability) and optionally an *e<sup>N</sup>* amplification method. MISES runs both in parallel – it constantly evaluates an e<sup>N</sup> criterion (with user-specified N<sub>crit</sub>) and the AGS correlation (based on freestream turbulence intensity) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=NCRIT%20%3D%20,%E2%80%9Cncrit%E2%80%9D%20for%20en%20transition%20model)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=transition)). Whichever predicts an earlier transition triggers the switch from laminar to turbulent BL. In practice, AGS is usually dominant for higher freestream turbulence (bypass transition), and e<sup>N</sup> for low-turbulence natural transition cases. We will implement both: the user can input either an N<sub>crit</sub> or a turbulence level (these will be related by an approximate Mack correlation as in MISES ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=match%20at%20L2034%20either%20one,respective%20input%20parameters%20ncrit%20and))). When transition is triggered at a certain location, the code will ramp the boundary layer model from laminar to turbulent over a finite *transition length*. We will follow AGS’s recommended method: start growing turbulent eddy viscosity from zero to full over a length scale proportional to momentum thickness, which avoids an instantaneous jump. Drela found that the original AGS formula was ill-posed when fully coupled, leading to oscillations (transition jumping forward and back) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=This%20was%20found%20to%20be,When%20transition)) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=onset%20point%20without%20also%20being,be%20obtained%20if%20a%20coarse)). He fixed this by reformulating the correlation in terms of *H* instead of λ (since in a two-equation model λ and H are not uniquely related during transition) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=%28%206,posed)) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=via%20the%20potential%20flow%20and,as%20shown%20in%20Figure%201)). We will ensure to use the *modified AGS* criterion as documented ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=1%20Ill,where%20%CE%BB%20%E2%89%A1%20%CE%B8%202)) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=The%20ill,point%20and%20drives%20%CE%BB%20more)), which provides a well-posed transition onset. For example, at a given turbulence level, transition may be predicted when *Re<sub>θ</sub>* exceeds a critical value that is a function of the instantaneous shape factor H (representing the instability of the boundary layer). This modification prevents the upstream influence feedback loop that can make the original AGS criterion unstable ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=via%20the%20potential%20flow%20and,as%20shown%20in%20Figure%201)) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=concerned%2C%20it%20is%20usually%20strong,With%20further%20iterations%2C%20it%20will)). 

**Turbulent Boundary Layer and Separation:** In turbulent regions, the momentum thickness growth will be computed with a closure that accounts for skin friction and dissipation. We’ll likely use the momentum-integral equation: \( \frac{d\theta}{ds} = \frac{C_f}{2} - \frac{d\delta^*}{ds} \) (where \(C_f\) is skin friction coefficient and δ* is displacement thickness). We will use an empirical correlation (e.g., a modified power-law or log-law correlation) for \(C_f\) in terms of local Reynolds number and perhaps pressure gradient (like Green’s lag law). MISES can predict separation by the integral method if the shape factor H becomes large. We will incorporate a separation criterion such as *H > H<sub>crit</sub>* (around 2.5 for laminar, ~3-4 for turbulent depending on Re). If separation is detected, the model can either terminate (indicating stall) or continue by modeling a separated shear layer (with large effective eddy viscosity). In MISES, mild separation bubbles can be handled (often transition will occur within them, reattaching the flow). We will allow simulation of limited separations as well, but the accuracy will drop for massive separations. The BL model will output key parameters along the surface: local skin friction, displacement thickness δ*, momentum thickness θ, shape factor H, and transition points. These will feed back into the inviscid solver.

## Coupled Viscous/Inviscid Iteration 
The inviscid flow and boundary layer must be solved in a *strongly coupled* manner, since each influences the other. MISES achieves this by iterating between the inviscid solver (ISES) and the boundary layer solver, effectively solving a nonlinear integral equation system. Our Python framework will do the same. The coupling works as follows ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=simplifies)): after each inviscid solution (which provides pressure and velocity distributions on the blade surfaces and along streamlines), the BL solver computes updated displacement thickness \( \delta^*(s) \) along each blade surface. This displacement thickness represents how much the effective shape of the blade grows due to the slow-moving boundary layer. We then modify the inviscid domain by *displacing the wall* outward by \( \delta^* \) in the normal direction (or equivalently, imposing a transpiration boundary condition to push the inviscid streamlines outward). Drela’s formulation in the m′–θ plane makes this particularly straightforward, as a normal offset in that plane corresponds directly to adding thickness in the real flow ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=The%20transformation%20from%20physical%20space,preserving.%20Hence)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=no%20transformation%20is%20required%20for,This%20simplifies)). After updating the geometry/domain for the inviscid solver, we resolve the inviscid flow. This process is iterated until convergence, typically when successive changes in \( \delta^* \) and surface pressures are below a threshold. Convergence can be accelerated by under-relaxation or by a Newton approach (MISES forms a Jacobian for the coupled system and often converges the viscous/inviscid loop in just a few iterations). 

 ([image]()) *Illustration of the coupled viscous–inviscid solution process and inverse design loop in the MISES Python implementation. The inviscid Euler solver and boundary layer solver iterate until a self-consistent flow is obtained (accounting for displacement thickness effects) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=simplifies)). In design mode, an optimizer adjusts the blade shape to meet target pressure distributions before the final converged solution is reached.* 

During the coupled iterations, special care is taken around transition. The interaction of transition with the inviscid flow can create a subtle upstream influence: as described by Drela, when transition first occurs, the sudden drop in displacement thickness acts like a local “sink”, slightly accelerating the upstream flow which in turn delays transition – this feedback can cause limit-cycle oscillations if not properly damped ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=The%20ill,point%20and%20drives%20%CE%BB%20more)) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=concerned%2C%20it%20is%20usually%20strong,With%20further%20iterations%2C%20it%20will)). By using the modified transition criterion and slight relaxation on the transition point movement, MISES ensures a stable converged solution. We will adopt similar practices. Another potential difficulty is with shock-induced separation: if a shock causes flow separation, the BL solver might struggle; in such cases the coupled solver may need additional relaxation or a shock-fitting approach. Nevertheless, for the vast majority of cases (attached or mildly separated flows), the iterative viscous–inviscid procedure converges rapidly to a physically consistent solution. This was a major finding of validation studies – e.g. MISES reliably predicted cascade performance including shock losses and separation onset for a range of incidences in a turbine cascade ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=ave%20generally%20shown%20MISES%20to,diffusion%20airfoils%20for%20different%20turbulence)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=Garzon%20and%20Darmofol%20%EF%BF%BD6%2C7%EF%BF%BD%20used,particularly%20suitable%20to%20such%20studies)).

## Inverse Design and Optimization 
Beyond analysis, MISES provides powerful inverse design capabilities, allowing users to specify desired surface pressure distributions or performance criteria and automatically modify the blade shape. We will incorporate two modes of inverse design: **modal inverse** and **parametric inverse**, mirroring the original system. In *modal inverse design*, the blade shape is adjusted as a linear combination of predefined mode shapes. The `modes.xxx` file in MISES contains these basis shapes (e.g. camber bending, thickness redistribution, leading edge shape, etc.), and the user can choose a subset of modes to participate ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=Geometry%20shape%20mode%20amplitudes,end)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=conditions%20that%20specify%20the%20flow,general%2C%20any%20number%20of%20global)). For example, one could define modes that thicken the trailing edge, or adjust the camber line curvature, and the solver will find the optimal amplitudes of these modes to achieve the target pressure distribution. In *parametric inverse design*, the blade’s defining parameters (from the bparm model) are directly adjusted. This might include parameters like leading edge radius, wedge angles, maximum thickness, etc. The advantage of parametric inverse is that it works in the original design space, ensuring the result corresponds to a manufacturable blade defined by the same parameters. 

Both inverse design approaches use a **least-squares pressure matching** technique ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=distribution%20in%20a%20least,Inverse%20method%20em)). The user specifies a target pressure (or pressure coefficient *C<sub>p</sub>*) distribution on the blade surfaces – often only on the suction side for aerodynamic design – and the solver iteratively modifies the geometry to minimize the sum-of-squared differences between current and target pressures. Drela extended the method to handle constraints and multiple objectives ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=match%20at%20L4797%20exceeds%20the,squares%20minimization%2C%20all%20the%20global)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=procedure%20is%20to%20drive%20geometry,where%20the%20blade%20shape%20is)). In our Python implementation, we will allow the user to set additional constraints such as: fixing the trailing-edge flow angle, maintaining a given throat area or thickness distribution, or minimizing profile loss. These constraints will be incorporated via Lagrange multipliers or by augmenting the least-squares system, similar to MISES’s global variable and constraint mechanism ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=4)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=does%20not%20admit%20any%20non,exit%20slope%20variable%20DSLEX)). For instance, one can enforce the Kutta condition (which MISES treats as a constraint automatically ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=,or%20by%20specifying))) and also require that the inlet flow angle or flow coefficient remain unchanged while redesigning the blade. 

Under the hood, the inverse design solves a linear system *J* Δx = –ΔCp (in a least-squares sense) where *J* is the sensitivity of surface pressures to shape changes (mode amplitudes or parameter changes). We will compute these sensitivities either via finite differences (perturbing each mode slightly and recording the pressure response) or by an adjoint method for efficiency. MISES includes a “Constrained Least-Squares-Inverse” procedure with precomputed sensitivities ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=supplemental%20document%20MISES%20Constrained%20Least,Formulation%20and%20Sensitivity)); for our Python code, given the moderate size of the problem (a few dozen design variables typically), finite-difference sensitivities are acceptable and simpler to implement initially. We will however modularize this so that an adjoint solver can be added later for faster optimization. The inverse design iteration (geometry update followed by flow resolution) continues until the pressure error is minimized. Note that in practice, perfect matching of target *C<sub>p</sub>* may not be possible if the target is too aggressive or outside the feasible design space; in that case the solver finds the closest match (in least-squares sense) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=other%20hand%2C%20Modal,squares%20sense%2C%20and%20is)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=It%20must%20be%20mentioned%20that,matching%20condition%20cannot%20be%20fully)). Users can then inspect the achieved pressure and decide if further manual tweaking or additional modes are needed. The end result is an optimized blade shape written out (we’ll provide output in a new blade coordinate file, or directly in a CAD format if desired) along with the flow solution.

## Input/Output Handling in Python 
The original MISES uses numerous text input files for different aspects of a case. We aim to streamline this with Python data structures, while preserving the clarity of having distinct categories of inputs. The key input files in MISES and their roles are ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=stream.xxx%20Required%20except%20for%20strictly,Specifies%20streamsurface%20radius%20and%20thick)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=ises,conditions%20and%20solver%20control%20flags)):

- **blade.xxx:** Blade surface coordinates (x, y) for one blade profile. Defines the airfoil shape discretely. *(Required unless using parametric input)*
- **bparm.xxx:** Blade geometry parameters for analytic shape generation. This file is parsed by user-specified routines to produce a shape. *(Required if blade.xxx is not used)*
- **stream.xxx:** Stream surface definition (spanwise radius and thickness distributions along the blade). Defines how a 3D blade section is positioned on a cylindrical or other stream surface ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=stream.xxx%20Required%20except%20for%20strictly,Specifies%20streamsurface%20radius%20and%20thick)). *(Required for quasi-3D cases, omitted for strictly 2D cases)*
- **loss.xxx:** Prescribed loss distribution (additional loss sources, e.g. distributed losses to simulate shocks or endwall effects). *(Optional)* 
- **suct.xxx:** Wall suction specification (locations and amounts of boundary layer suction if used for control). *(Optional)*
- **ises.xxx:** Flow condition and solver control file. This is the main configuration input to the ISES solver, containing freestream conditions (Mach, Reynolds, inlet angle, turbulence level), and an array of flags and parameters toggling solver options ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=suct,suction%20locations)). For instance, ISMOM mode, whether to run in design mode, how many blades in cascade, etc., are set here.
- **modes.xxx:** Geometry mode shapes for inverse design. *(Optional, only for modal inverse)*
- **bplist.xxx:** Parameter list specifying which geometry parameters to modify in a parametric inverse design. *(Optional, only for parametric inverse)*
- **idat.xxx:** The state file (grid and flow solution) – this is actually an output of ISET (initialization) and input to ISES (flow solver) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=flow%20data%20file%20for%20a,where%20%E2%80%9Cxxx%E2%80%9D%20is%20an%20extension)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=condition%20file%20ises,The)), stored in binary in original MISES.

In our Python framework, we will replace these scattered files with a more unified input system. We envision a Python dictionary or a JSON/YAML file that encapsulates all necessary info for a given run. For example, a single YAML could contain a section for “geometry” (either listing coordinates or pointing to a parametric shape function and parameters), a section for “flow conditions” (Mach, Re, pressures, etc.), and a section for “solver_options” (flags like grid topology, number of grid points, whether to run inverse design, etc.). This will improve usability by having one coherent case definition file. However, we will maintain the ability to import/export the traditional file formats for compatibility – e.g. a function to read a `blade.dat` file into our geometry structure, or to write out the final geometry to a `blade.new` file in the same format. The Python data structures might look like: 

```python
case = {
  "geometry": {
      "type": "coordinates",
      "coords": [(x1,y1), (x2,y2), ...],
      "thickness_mod": 1.0  # example of param, etc.
  },
  "stream": {
      "radius": 0.5,
      "radius_distribution": [...],
      "thickness_distribution": [...]
  },
  "flow": {
      "Mach_in": 0.65,
      "p_out/p_in": 0.72,
      "Re": 1.5e6,
      "turbulence_pct": 3.0,
      "incidence_angle": 2.0
  },
  "solver": {
      "grid_topology": ["H","C"],  # inlet H-type, outlet C-type grid
      "N_surface": 150,
      "N_stream": 30,
      "ISMOM": 4,
      "inverse_design": False
  }
}
```

This is just an illustrative snippet. We will provide classes to validate and store these inputs (e.g. a `BladeGeometry` class with methods to generate coordinates from parameters, a `FlowCondition` class to compute nondimensional inputs, etc.). During runtime, there will be objects like `grid = Mesh(bladeGeom, streamSurf, grid_params)` and `flow_solution = FlowSolution(grid, flow_conditions)` for clarity. Output data (such as surface pressure distribution, velocity field, BL profiles) will be stored in convenient Python data structures (NumPy arrays, Pandas dataframes) rather than written to dozens of separate text files as in the original. This modern approach will make it easier to perform further analyses (such as design sweeps or uncertainty studies) programmatically, without having to orchestrate external file writes and reads.

For compatibility and verification, we may include an **import module** that can read an existing set of MISES files and populate our Python structures. This will allow cross-verification: we can take known test cases (like those from the MISES manual or ASME paper), run them through our Python code, and ensure the results agree with the published MISES results within an acceptable tolerance.

## Visualization and Post-Processing 
Interactive and high-quality visualization will be integrated into the Python MISES tool. Key visualization capabilities include:

- **Geometry and Grid Display:** Plotting the blade shape and the computational mesh in the m′–θ plane (or physical coordinates). This helps verify the grid orthogonality and clustering. For example, we can visualize streamlines emanating from the leading edge and wrapping to the trailing edge, and inspect cell aspect ratios. Any streamtube thickness variation (3D effects) can be shown by drawing the blade at multiple spanwise stations if needed.

- **Surface Pressure and BL Parameters:** Plotting distributions of pressure coefficient *C<sub>p</sub>* along the blade (both suction and pressure side). This is crucial for aerodynamic understanding and was a primary output in the MISES validation (e.g., loading distribution comparisons) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=4,from%20a%20subsonic%20level%20of)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=Figures%204%EF%BF%BDd%EF%BF%BD%20and%204%EF%BF%BDe%EF%BF%BD%20characterize,good%20job%20of%20predicting%20load)). We will also plot boundary layer parameters such as skin friction *C<sub>f</sub>* (to identify laminar, transitional, turbulent regions), shape factor *H*, and momentum thickness Reynolds number *Re<sub>θ</sub>*. These can be shown in a stacked plot or annotated on the geometry. For instance, markers can denote the transition point or separation point on the surface.

- **Flow Field Contours:** One of the most informative visualizations is a contour plot of Mach number (or static pressure) in the blade-to-blade passage. We will use matplotlib or a similar library to draw filled contour maps of Mach number throughout the domain. This will illustrate shock waves, expansions, and wake development between blades. As an example, **Figure 1** below shows Mach number contours for a transonic compressor blade cascade computed by MISES, with a shock emanating from the suction surface ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=The%20great%20advantage%20of%20a,more%20tolerant%20of%20shock%20waves)). Our Python code will be able to produce such a plot for any case, with a color scale and contour lines for quantitative reading. We will also allow streamlines or particle traces through the field to visualize the flow turning and any separation bubbles. 

 ([MISES](http://web.mit.edu/drela/Public/web/mises/)) *Figure 1: Mach number contours in a blade passage computed by MISES (sample high-speed compressor case). A strong shock is visible on the suction side (red-orange region), highlighting the code’s ability to capture compressibility effects. Nearly orthogonal grid lines were used downstream (offset grid) to accurately resolve the shock with minimal numerical smearing ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=The%20great%20advantage%20of%20a,more%20tolerant%20of%20shock%20waves)). Such visualizations will be generated by the Python tool for analysis of flow features.* 

- **Wake Profiles and Loss Coefficients:** MISES computes the profile loss by mixing out the flow at the exit. We will produce plots of the wake total pressure deficit (or kinetic energy loss coefficient) across the span of the passage. For example, plotting total pressure loss vs. span or vs. pitchwise coordinate at a downstream plane helps evaluate how the boundary layer and trailing edge thickness contribute to losses. We can also directly compute an overall loss coefficient (Y_p) and plot its variation with incidence or Mach number, generating polar curves similar to those in the ASME validation ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=code%2C%20MISES%2C%20versus%20experimental%20data,deg%20relative%20to%20design%20incidence)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=Garzon%20and%20Darmofol%20%EF%BF%BD6%2C7%EF%BF%BD%20used,particularly%20suitable%20to%20such%20studies)). Our tool will support generating such performance maps by running the solver at multiple conditions (akin to MISES’s POLAR mode, which automates sweeps of parameters).

- **Design Mode Visualization:** In inverse design cases, we will visualize both the target and achieved pressure distributions to show convergence. Additionally, we can animate or plot the intermediate blade shapes as the optimizer iterates, which provides insight into how the geometry changes. 

Technically, we will rely on Python libraries like Matplotlib for static 2D plots, and possibly Plotly or Bokeh for interactive graphics (so a user can zoom into the pressure distribution, etc.). All plots will be labeled with dimensional or nondimensional units as appropriate, and we will include reference annotations (e.g., marking the sonic line *M=1* on Mach plots, marking transition points on *C<sub>f</sub>* plots, etc.). By integrating plotting into the solver workflow, a user can immediately see results after a run, rather than manually inputting data into a separate plotting program (MISES originally provided an interactive plotting tool IPLOT ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=Additional%20design%20condition%20information%20can,the%20state%20file%20using%20the)), which we replace with Python’s built-in plotting).

## Validation and Examples 
Rigorous validation will be performed by comparing the Python MISES solver against known results from both the MISES 2.63 user guide and the ASME validation study by Andrew and Kahveci. For instance, the ASME paper provides experimental data and MISES predictions for a 2D high-pressure turbine cascade over a range of conditions ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=Code%20for%20High,quickly%20for%20each%20of%20many)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=ture%20loss%2C%20turning%2C%20and%20loading,2%20and%20across%20a%20range)). Key metrics to validate include: blade loading (pressure distribution), flow turning (outlet flow angle), and total pressure loss. The paper reports that MISES was able to predict these with good accuracy across Mach 0.5 to 1.2 and incidence from –10° to +14.5° ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=code%2C%20MISES%2C%20versus%20experimental%20data,deg%20relative%20to%20design%20incidence)), except under the most extreme off-design where thick separated boundary layers occur ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=match%20at%20L221%20cascade%20experiment,design)). We will run our Python code for the same cascade cases: for each incidence and Mach number, ensuring the input (Mach, Reynolds, turbulence) matches the test, and then comparing our output to the published MISES results (which in turn were validated against experiment). We expect to see excellent agreement, since we are implementing the same physical models. Any discrepancy will be investigated – for example, if losses are under-predicted, we will check our turbulent BL closure and perhaps refine the separation model.

Additionally, we will test low-speed compressor cases, such as the ones provided in Drela’s sample calculations (e.g., a controlled-diffusion airfoil from NASA or an E/CRM compressor profile). Those cases often involve significant laminar run and transition, providing a check on our transition modeling. Schreiber et al. showed MISES can accurately predict transition location for low free-stream turbulence (~1–2%) on a compressor airfoil ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=ave%20generally%20shown%20MISES%20to,diffusion%20airfoils%20for%20different%20turbulence)), largely thanks to the e<sup>N</sup> model – we will replicate such a case to ensure our e<sup>N</sup> implementation yields the correct *N<sub>crit</sub>* for transition at the measured location. We will also test a transonic fan tip section where shocks and possibly shock-induced separation occur, to validate the shock capturing and any limit cycle behavior of the coupling. Sondergaard et al. noted some cases where MISES did not predict large separations in an LPT (low-pressure turbine) at very low Reynolds numbers ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=Sondergaard%20et%20al,turbine%2C%20noting%20instances%20wherein%20MISES)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=match%20at%20L221%20cascade%20experiment,design)). Such challenging cases will serve to push the limits of our code; we can identify if our BL model needs augmentation (e.g., a better separated-flow model or coupling with a two-zone model for separation).

Throughout validation, we will use the same input parameters as the original MISES (e.g., the same *N<sub>crit</sub>* values, same turbulence intensities, same mode shapes for design tests) to ensure one-to-one comparison. Since our code outputs data in Python, we can also directly compute error metrics (like RMS difference in *C<sub>p</sub>* or percentage error in loss) to quantify performance. The expectation is that the Python implementation can match MISES’s results within a small tolerance, confirming that the algorithms have been correctly reproduced. Any deviations will guide further refinement of the models.

Finally, we plan to demonstrate the Python MISES on a full design loop: for example, take an initial compressor blade, specify a target pressure distribution that is more front-loaded (to increase lift), and use the inverse design optimizer to reshape the blade. The resulting design will be checked for performance improvements and any adverse effects (like increased loss or shock strength). This will illustrate that all components – geometry parameterization, flow solver, BL, coupling, and optimizer – are working in harmony. By cross-referencing the outcomes with those documented in the MISES manual’s redesign examples and the literature (e.g., improvements in diffusion factor or blade loading achieved by redesign), we validate not just the analysis mode but the design capabilities of the code.

In summary, recreating the MISES solver in Python involves replicating a suite of well-honed numerical methods: streamline-based grid generation, a robust quasi-3D Euler solver with low dissipation, a two-equation integral boundary layer with sophisticated transition modeling, and a tightly integrated inverse design algorithm. By following the original documentation and verified implementations ([MISES - Software for Design and Analysis of Turbomachinery Blading | MIT Technology Licensing Office](https://tlo.mit.edu/industry-entrepreneurs/available-technologies/mises-software-design-and-analysis-turbomachinery#:~:text=wide%20range%20of%20Mach%20and,glows%20including%20transition%20and%20separation)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=MISES%2C%20a%20blade,been%20used%20extensively%20in%20turboma)), and by leveraging modern computing tools, the Python version will serve as both a research tool and an educational code. It allows deeper insight into turbomachinery aerodynamics by enabling users to modify and extend models (thanks to open Python code) and immediately see the impact. The successful validation against known cases will give confidence that this new implementation can reliably be used for cascade analysis and design optimization in the same spirit as Drela’s landmark MISES code. 

**Sources:**

1. Mark Drela and Harold Youngren, *“A User’s Guide to MISES 2.63,”* MIT Aero & Astro, Feb. 2008 ([MISES - Software for Design and Analysis of Turbomachinery Blading | MIT Technology Licensing Office](https://tlo.mit.edu/industry-entrepreneurs/available-technologies/mises-software-design-and-analysis-turbomachinery#:~:text=wide%20range%20of%20Mach%20and,glows%20including%20transition%20and%20separation)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=blade,shape%20via%20a%20relatively%20large)).  
2. Philip L. Andrew and Harika S. Kahveci, *“Validation of MISES Two-Dimensional Boundary Layer Code for High-Pressure Turbine Aerodynamic Design,”* *J. Turbomachinery*, vol. 131, no. 3, 2009 ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=Code%20for%20High,quickly%20for%20each%20of%20many)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=ave%20generally%20shown%20MISES%20to,diffusion%20airfoils%20for%20different%20turbulence)).  
3. Mark Drela, *“MISES Implementation of Modified Abu-Ghannam/Shaw Transition Criterion (Second Revision),”* MIT Aero & Astro, July 1998 ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=1%20Ill,where%20%CE%BB%20%E2%89%A1%20%CE%B8%202)) ([](http://web.mit.edu/drela/Public/web/mises/ags2.pdf#:~:text=The%20ill,point%20and%20drives%20%CE%BB%20more)).  
4. Schreiber et al., *“Measurement and Prediction of Transition on Compressor Airfoils,”* *ASME J. Turbomachinery*, 1995 (as cited in Andrew & Kahveci) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=ave%20generally%20shown%20MISES%20to,diffusion%20airfoils%20for%20different%20turbulence)) ([031013_1.pdf](file://file-3snMGVUSLLSRuDX79MKMBM#:~:text=he%20ability%20of%20the%20transition,%EF%BF%BD.%20The%20study)).  
5. Harold Youngren, *“MISES Constrained Least-Squares Inverse Formulation and Sensitivity Calculation Procedures,”* MIT, 1998 (referenced in MISES manual) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=supplemental%20document%20MISES%20Constrained%20Least,Formulation%20and%20Sensitivity)) ([mises.pdf](file://file-MoSJs2W3uarPi6Lmyevbux#:~:text=It%20must%20be%20mentioned%20that,matching%20condition%20cannot%20be%20fully)).